package lib

import (
	"encoding/json"
	"testing"
)

var buildsResponse = []byte(`
[
    {
        "id": "071e0979-8671-4904-be5a-0b18fb5ba09b",
        "graphql_id": "QnVpbGQtLS0wNzFlMDk3OS04NjcxLTQ5MDQtYmU1YS0wYjE4ZmI1YmEwOWI=",
        "url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/944",
        "web_url": "https://buildkite.com/example/example_repo/builds/944",
        "number": 944,
        "state": "running",
        "blocked": false,
        "blocked_state": "",
        "message": "span/kafka: skip tests with offline Kafka server\n\nThese tests cause CI failures when we ask the CI environment to run\nthe spancat tests.\n\nFixes #166.",
        "commit": "4416ce9a1bbd38505c72f8f9d034a45c41b02a02",
        "branch": "master",
        "tag": null,
        "env": {},
        "source": "webhook",
        "author": {
            "username": "kevinburkeexample",
            "name": "Kevin Burke",
            "email": "kevin.burke@example.com"
        },
        "creator": {
            "id": "96ba0039-c9f3-45bb-8039-23705197a20d",
            "graphql_id": "VXNlci0tLTk2YmEwMDM5LWM5ZjMtNDViYi04MDM5LTIzNzA1MTk3YTIwZA==",
            "name": "Kevin Burke",
            "email": "kevin.burke@example.com",
            "avatar_url": "https://www.gravatar.com/avatar/b6fb7afdae89b8470c0bed5b5ea7156c",
            "created_at": "2021-12-15T22:37:55.752Z"
        },
        "created_at": "2022-03-08T19:15:54.616Z",
        "scheduled_at": "2022-03-08T19:15:54.593Z",
        "started_at": "2022-03-08T19:15:59.447Z",
        "finished_at": null,
        "meta_data": {
            "buildkite:git:commit": "commit 4416ce9a1bbd38505c72f8f9d034a45c41b02a02\nAuthor:     Kevin Burke <kevin.burke@example.com>\nAuthorDate: Mon Mar 7 21:46:05 2022 -0800\nCommit:     Kevin Burke <kevin.burke@example.com>\nCommitDate: Tue Mar 8 10:15:32 2022 -0800\n\n    span/kafka: skip tests with offline Kafka server\n    \n    These tests cause CI failures when we ask the CI environment to run\n    the spancat tests.\n    \n    Fixes #166."
        },
        "pull_request": null,
        "rebuilt_from": null,
        "pipeline": {
            "id": "632fa93f-af7b-4bbb-a2be-58f1f6f18300",
            "graphql_id": "UGlwZWxpbmUtLS02MzJmYTkzZi1hZjdiLTRiYmItYTJiZS01OGYxZjZmMTgzMDA=",
            "url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo",
            "web_url": "https://buildkite.com/example/example_repo",
            "name": "example_repo",
            "description": null,
            "slug": "example_repo",
            "repository": "git@github.com:example/example_repo.git",
            "cluster_id": null,
            "branch_configuration": null,
            "default_branch": "master",
            "skip_queued_branch_builds": false,
            "skip_queued_branch_builds_filter": null,
            "cancel_running_branch_builds": false,
            "cancel_running_branch_builds_filter": null,
            "allow_rebuilds": true,
            "provider": {
                "id": "github",
                "settings": {
                    "trigger_mode": "code",
                    "build_pull_requests": true,
                    "pull_request_branch_filter_enabled": false,
                    "skip_builds_for_existing_commits": false,
                    "skip_pull_request_builds_for_existing_commits": true,
                    "build_pull_request_ready_for_review": false,
                    "build_pull_request_labels_changed": false,
                    "build_pull_request_forks": false,
                    "prefix_pull_request_fork_branch_names": true,
                    "build_branches": true,
                    "build_tags": false,
                    "cancel_deleted_branch_builds": false,
                    "publish_commit_status": true,
                    "publish_commit_status_per_step": false,
                    "separate_pull_request_statuses": false,
                    "publish_blocked_as_pending": false,
                    "use_step_key_as_commit_status": false,
                    "filter_enabled": false,
                    "repository": "example/example_repo"
                },
                "webhook_url": "https://webhook.buildkite.com/deliver/a8b7d1ec0e383c14108b9d814c76173fe17da74ae1f35a5f0c"
            },
            "builds_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds",
            "badge_url": "https://badge.buildkite.com/7d154fae54d51f386ce4db0a5f1194690e614425ea9f3726ba.svg",
            "created_by": {
                "id": "52ddcfda-658d-404a-b2d2-b006f3c7a2ad",
                "graphql_id": "VXNlci0tLTUyZGRjZmRhLTY1OGQtNDA0YS1iMmQyLWIwMDZmM2M3YTJhZA==",
                "name": "Buildkite Bot",
                "email": "tooling-team+buildkite-bot@example.com",
                "avatar_url": "https://www.gravatar.com/avatar/f802d3f82304aaebaed6d934e9ce231c",
                "created_at": "2019-06-26T00:02:51.775Z"
            },
            "created_at": "2020-07-28T23:16:52.812Z",
            "archived_at": null,
            "env": {},
            "scheduled_builds_count": 0,
            "running_builds_count": 1,
            "scheduled_jobs_count": 0,
            "running_jobs_count": 2,
            "waiting_jobs_count": 0,
            "visibility": "private",
            "tags": null,
            "steps": [
                {
                    "type": "script",
                    "name": ":pipeline:",
                    "command": "buildkite-agent pipeline upload",
                    "artifact_paths": null,
                    "branch_configuration": null,
                    "env": {},
                    "timeout_in_minutes": null,
                    "agent_query_rules": [],
                    "concurrency": null,
                    "parallelism": null
                }
            ]
        },
        "jobs": [
            {
                "id": "fca912da-fe38-4bf5-b8df-980ce0367aff",
                "graphql_id": "Sm9iLS0tZmNhOTEyZGEtZmUzOC00YmY1LWI4ZGYtOTgwY2UwMzY3YWZm",
                "type": "script",
                "name": ":pipeline:",
                "step_key": null,
                "priority": {
                    "number": 0
                },
                "agent_query_rules": [],
                "state": "passed",
                "build_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/944",
                "web_url": "https://buildkite.com/example/example_repo/builds/944#fca912da-fe38-4bf5-b8df-980ce0367aff",
                "log_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/944/jobs/fca912da-fe38-4bf5-b8df-980ce0367aff/log",
                "raw_log_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/944/jobs/fca912da-fe38-4bf5-b8df-980ce0367aff/log.txt",
                "artifacts_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/944/jobs/fca912da-fe38-4bf5-b8df-980ce0367aff/artifacts",
                "command": "buildkite-agent pipeline upload",
                "soft_failed": false,
                "exit_status": 0,
                "artifact_paths": null,
                "agent": {
                    "id": "ea21056f-2e4f-45e2-af25-6a184c30cc3e",
                    "url": "https://api.buildkite.com/v2/organizations/example/agents/ea21056f-2e4f-45e2-af25-6a184c30cc3e",
                    "web_url": "https://buildkite.com/organizations/example/agents/ea21056f-2e4f-45e2-af25-6a184c30cc3e",
                    "name": "buildkite-ci-033404905f9532bfd",
                    "connection_state": "connected",
                    "ip_address": "35.161.192.168",
                    "hostname": "buildkite-ci-033404905f9532bfd",
                    "user_agent": "buildkite-agent/3.22.1.x (linux; amd64)",
                    "version": "3.22.1",
                    "creator": null,
                    "created_at": "2022-03-08T18:46:08.520Z",
                    "job": null,
                    "last_job_finished_at": "2022-03-08T19:16:14.460Z",
                    "priority": 0,
                    "meta_data": [
                        "queue=v1",
                        "queue=default",
                        "queue=green-prod",
                        "aws:instance-id=i-033404905f9532bfd",
                        "aws:instance-type=c5.4xlarge",
                        "aws:ami-id=ami-0c03484256f7dde60",
                        "Name=buildkite-v1-green-0",
                        "aws:ec2launchtemplate:id=lt-00d7f6fc105994097",
                        "kind=buildkite",
                        "queues=v1,default,green-prod",
                        "aws:autoscaling:groupName=buildkite-v1-green-0",
                        "aws:ec2:fleet-id=fleet-f6cba4e3-57d7-ea11-a41a-830226b1deab",
                        "aws:ec2launchtemplate:version=4",
                        "debug=false",
                        "name=buildkite-v1-green-0"
                    ]
                },
                "created_at": "2022-03-08T19:15:54.607Z",
                "scheduled_at": "2022-03-08T19:15:54.607Z",
                "runnable_at": "2022-03-08T19:15:54.703Z",
                "started_at": "2022-03-08T19:15:59.447Z",
                "finished_at": "2022-03-08T19:16:14.429Z",
                "retried": false,
                "retried_in_job_id": null,
                "retries_count": null,
                "retry_type": null,
                "parallel_group_index": null,
                "parallel_group_total": null,
                "matrix": null
            },
            {
                "id": "a91ee8ba-b32e-4534-ac5b-221e28cbacb0",
                "graphql_id": "Sm9iLS0tYTkxZWU4YmEtYjMyZS00NTM0LWFjNWItMjIxZTI4Y2JhY2Iw",
                "type": "script",
                "name": "test",
                "step_key": null,
                "priority": {
                    "number": 0
                },
                "agent_query_rules": [
                    "queue=v1"
                ],
                "state": "running",
                "build_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/944",
                "web_url": "https://buildkite.com/example/example_repo/builds/944#a91ee8ba-b32e-4534-ac5b-221e28cbacb0",
                "log_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/944/jobs/a91ee8ba-b32e-4534-ac5b-221e28cbacb0/log",
                "raw_log_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/944/jobs/a91ee8ba-b32e-4534-ac5b-221e28cbacb0/log.txt",
                "artifacts_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/944/jobs/a91ee8ba-b32e-4534-ac5b-221e28cbacb0/artifacts",
                "command": "make deps\nmake vendor\nbk-snyk\nmake test\n",
                "soft_failed": false,
                "exit_status": null,
                "artifact_paths": null,
                "agent": {
                    "id": "81745862-79f9-4586-acbc-9294775413ef",
                    "url": "https://api.buildkite.com/v2/organizations/example/agents/81745862-79f9-4586-acbc-9294775413ef",
                    "web_url": "https://buildkite.com/organizations/example/agents/81745862-79f9-4586-acbc-9294775413ef",
                    "name": "buildkite-ci-08ad47255e6b75f7d",
                    "connection_state": "connected",
                    "ip_address": "35.161.192.168",
                    "hostname": "buildkite-ci-08ad47255e6b75f7d",
                    "user_agent": "buildkite-agent/3.22.1.x (linux; amd64)",
                    "version": "3.22.1",
                    "creator": null,
                    "created_at": "2022-03-08T18:26:42.217Z",
                    "job": null,
                    "last_job_finished_at": "2022-03-08T19:03:00.576Z",
                    "priority": 0,
                    "meta_data": [
                        "queue=v1",
                        "queue=default",
                        "queue=blue-prod",
                        "aws:instance-type=c5.4xlarge",
                        "aws:ami-id=ami-0c03484256f7dde60",
                        "aws:instance-id=i-08ad47255e6b75f7d",
                        "debug=false",
                        "Name=buildkite-v1-0",
                        "aws:autoscaling:groupName=buildkite-v1-0",
                        "aws:ec2launchtemplate:id=lt-0f2b1709119aaaaaa",
                        "name=buildkite-v1-0",
                        "queues=v1,default,blue-prod",
                        "aws:ec2:fleet-id=fleet-7ceb0cc3-5dfd-e011-8eb8-0b02875bf4ea",
                        "aws:ec2launchtemplate:version=11",
                        "kind=buildkite"
                    ]
                },
                "created_at": "2022-03-08T19:16:10.402Z",
                "scheduled_at": "2022-03-08T19:15:54.607Z",
                "runnable_at": "2022-03-08T19:16:10.463Z",
                "started_at": "2022-03-08T19:16:13.509Z",
                "finished_at": null,
                "retried": false,
                "retried_in_job_id": null,
                "retries_count": null,
                "retry_type": null,
                "parallel_group_index": null,
                "parallel_group_total": null,
                "matrix": null
            },
            {
                "id": "1d463a6c-dfde-4d0f-9450-9aac99a9ae70",
                "graphql_id": "Sm9iLS0tMWQ0NjNhNmMtZGZkZS00ZDBmLTk0NTAtOWFhYzk5YTlhZTcw",
                "type": "script",
                "name": "publish",
                "step_key": null,
                "priority": {
                    "number": 0
                },
                "agent_query_rules": [
                    "queue=v1"
                ],
                "state": "assigned",
                "build_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/944",
                "web_url": "https://buildkite.com/example/example_repo/builds/944#1d463a6c-dfde-4d0f-9450-9aac99a9ae70",
                "log_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/944/jobs/1d463a6c-dfde-4d0f-9450-9aac99a9ae70/log",
                "raw_log_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/944/jobs/1d463a6c-dfde-4d0f-9450-9aac99a9ae70/log.txt",
                "artifacts_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/944/jobs/1d463a6c-dfde-4d0f-9450-9aac99a9ae70/artifacts",
                "command": "make vendor\nmake publish branch=master commit=4416ce9\nmake publish branch=master commit=4416ce9 tags=debug\nbuildkite-agent annotate \"Image: $(make image branch=master commit=4416ce9)\" --style 'success' --context 'ctx-success'\nbuildkite-agent annotate \"Debug image: $(make image branch=master commit=4416ce9 tags=debug)\" --style 'info' --context 'ctx-success'\n",
                "soft_failed": false,
                "exit_status": null,
                "artifact_paths": null,
                "agent": {
                    "id": "c88c7046-b4e0-44bf-9f76-7c8a9d5d5b69",
                    "url": "https://api.buildkite.com/v2/organizations/example/agents/c88c7046-b4e0-44bf-9f76-7c8a9d5d5b69",
                    "web_url": "https://buildkite.com/organizations/example/agents/c88c7046-b4e0-44bf-9f76-7c8a9d5d5b69",
                    "name": "buildkite-ci-0fd5d67ba2baafdc2",
                    "connection_state": "connected",
                    "ip_address": "35.161.192.168",
                    "hostname": "buildkite-ci-0fd5d67ba2baafdc2",
                    "user_agent": "buildkite-agent/3.22.1.x (linux; amd64)",
                    "version": "3.22.1",
                    "creator": null,
                    "created_at": "2022-03-08T18:36:57.710Z",
                    "job": null,
                    "last_job_finished_at": "2022-03-08T19:02:27.854Z",
                    "priority": 0,
                    "meta_data": [
                        "queue=v1",
                        "queue=default",
                        "queue=blue-prod",
                        "aws:ami-id=ami-0c03484256f7dde60",
                        "aws:instance-id=i-0fd5d67ba2baafdc2",
                        "aws:instance-type=c5.4xlarge",
                        "aws:ec2launchtemplate:id=lt-0f2b1709119aaaaaa",
                        "debug=false",
                        "aws:autoscaling:groupName=buildkite-v1-0",
                        "aws:ec2:fleet-id=fleet-544b0669-755f-48b3-26b2-01a2c868555d",
                        "kind=buildkite",
                        "name=buildkite-v1-0",
                        "queues=v1,default,blue-prod",
                        "Name=buildkite-v1-0",
                        "aws:ec2launchtemplate:version=11"
                    ]
                },
                "created_at": "2022-03-08T19:16:10.402Z",
                "scheduled_at": "2022-03-08T19:15:54.607Z",
                "runnable_at": "2022-03-08T19:16:10.463Z",
                "started_at": null,
                "finished_at": null,
                "retried": false,
                "retried_in_job_id": null,
                "retries_count": null,
                "retry_type": null,
                "parallel_group_index": null,
                "parallel_group_total": null,
                "matrix": null
            }
        ]
    },
    {
        "id": "53e3f666-28f0-4f08-8de0-c0f6c38fe037",
        "graphql_id": "QnVpbGQtLS01M2UzZjY2Ni0yOGYwLTRmMDgtOGRlMC1jMGY2YzM4ZmUwMzc=",
        "url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/943",
        "web_url": "https://buildkite.com/example/example_repo/builds/943",
        "number": 943,
        "state": "passed",
        "blocked": false,
        "blocked_state": "",
        "message": "span/kafka: skip tests with offline Kafka server\n\nThese tests cause CI failures when we ask the CI environment to run\nthe spancat tests.\n\nFixes #166.",
        "commit": "4416ce9a1bbd38505c72f8f9d034a45c41b02a02",
        "branch": "spancat-ci",
        "tag": null,
        "env": {},
        "source": "webhook",
        "author": {
            "username": "kevinburkeexample",
            "name": "Kevin Burke",
            "email": "kevin.burke@example.com"
        },
        "creator": {
            "id": "96ba0039-c9f3-45bb-8039-23705197a20d",
            "graphql_id": "VXNlci0tLTk2YmEwMDM5LWM5ZjMtNDViYi04MDM5LTIzNzA1MTk3YTIwZA==",
            "name": "Kevin Burke",
            "email": "kevin.burke@example.com",
            "avatar_url": "https://www.gravatar.com/avatar/b6fb7afdae89b8470c0bed5b5ea7156c",
            "created_at": "2021-12-15T22:37:55.752Z"
        },
        "created_at": "2022-03-08T18:15:36.301Z",
        "scheduled_at": "2022-03-08T18:15:36.268Z",
        "started_at": "2022-03-08T18:15:37.813Z",
        "finished_at": "2022-03-08T18:17:36.199Z",
        "meta_data": {
            "buildkite:git:commit": "commit 4416ce9a1bbd38505c72f8f9d034a45c41b02a02\nAuthor:     Kevin Burke <kevin.burke@example.com>\nAuthorDate: Mon Mar 7 21:46:05 2022 -0800\nCommit:     Kevin Burke <kevin.burke@example.com>\nCommitDate: Tue Mar 8 10:15:32 2022 -0800\n\n    span/kafka: skip tests with offline Kafka server\n    \n    These tests cause CI failures when we ask the CI environment to run\n    the spancat tests.\n    \n    Fixes #166."
        },
        "pull_request": {
            "id": "167",
            "base": "master",
            "repository": "git://github.com/example/example_repo.git"
        },
        "rebuilt_from": null,
        "pipeline": {
            "id": "632fa93f-af7b-4bbb-a2be-58f1f6f18300",
            "graphql_id": "UGlwZWxpbmUtLS02MzJmYTkzZi1hZjdiLTRiYmItYTJiZS01OGYxZjZmMTgzMDA=",
            "url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo",
            "web_url": "https://buildkite.com/example/example_repo",
            "name": "example_repo",
            "description": null,
            "slug": "example_repo",
            "repository": "git@github.com:example/example_repo.git",
            "cluster_id": null,
            "branch_configuration": null,
            "default_branch": "master",
            "skip_queued_branch_builds": false,
            "skip_queued_branch_builds_filter": null,
            "cancel_running_branch_builds": false,
            "cancel_running_branch_builds_filter": null,
            "allow_rebuilds": true,
            "provider": {
                "id": "github",
                "settings": {
                    "trigger_mode": "code",
                    "build_pull_requests": true,
                    "pull_request_branch_filter_enabled": false,
                    "skip_builds_for_existing_commits": false,
                    "skip_pull_request_builds_for_existing_commits": true,
                    "build_pull_request_ready_for_review": false,
                    "build_pull_request_labels_changed": false,
                    "build_pull_request_forks": false,
                    "prefix_pull_request_fork_branch_names": true,
                    "build_branches": true,
                    "build_tags": false,
                    "cancel_deleted_branch_builds": false,
                    "publish_commit_status": true,
                    "publish_commit_status_per_step": false,
                    "separate_pull_request_statuses": false,
                    "publish_blocked_as_pending": false,
                    "use_step_key_as_commit_status": false,
                    "filter_enabled": false,
                    "repository": "example/example_repo"
                },
                "webhook_url": "https://webhook.buildkite.com/deliver/a8b7d1ec0e383c14108b9d814c76173fe17da74ae1f35a5f0c"
            },
            "builds_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds",
            "badge_url": "https://badge.buildkite.com/7d154fae54d51f386ce4db0a5f1194690e614425ea9f3726ba.svg",
            "created_by": {
                "id": "52ddcfda-658d-404a-b2d2-b006f3c7a2ad",
                "graphql_id": "VXNlci0tLTUyZGRjZmRhLTY1OGQtNDA0YS1iMmQyLWIwMDZmM2M3YTJhZA==",
                "name": "Buildkite Bot",
                "email": "tooling-team+buildkite-bot@example.com",
                "avatar_url": "https://www.gravatar.com/avatar/f802d3f82304aaebaed6d934e9ce231c",
                "created_at": "2019-06-26T00:02:51.775Z"
            },
            "created_at": "2020-07-28T23:16:52.812Z",
            "archived_at": null,
            "env": {},
            "scheduled_builds_count": 0,
            "running_builds_count": 1,
            "scheduled_jobs_count": 0,
            "running_jobs_count": 2,
            "waiting_jobs_count": 0,
            "visibility": "private",
            "tags": null,
            "steps": [
                {
                    "type": "script",
                    "name": ":pipeline:",
                    "command": "buildkite-agent pipeline upload",
                    "artifact_paths": null,
                    "branch_configuration": null,
                    "env": {},
                    "timeout_in_minutes": null,
                    "agent_query_rules": [],
                    "concurrency": null,
                    "parallelism": null
                }
            ]
        },
        "jobs": [
            {
                "id": "5ee91b85-8f51-4f04-a2ca-64814c631afa",
                "graphql_id": "Sm9iLS0tNWVlOTFiODUtOGY1MS00ZjA0LWEyY2EtNjQ4MTRjNjMxYWZh",
                "type": "script",
                "name": ":pipeline:",
                "step_key": null,
                "priority": {
                    "number": 0
                },
                "agent_query_rules": [],
                "state": "passed",
                "build_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/943",
                "web_url": "https://buildkite.com/example/example_repo/builds/943#5ee91b85-8f51-4f04-a2ca-64814c631afa",
                "log_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/943/jobs/5ee91b85-8f51-4f04-a2ca-64814c631afa/log",
                "raw_log_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/943/jobs/5ee91b85-8f51-4f04-a2ca-64814c631afa/log.txt",
                "artifacts_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/943/jobs/5ee91b85-8f51-4f04-a2ca-64814c631afa/artifacts",
                "command": "buildkite-agent pipeline upload",
                "soft_failed": false,
                "exit_status": 0,
                "artifact_paths": null,
                "agent": {
                    "id": "51a78a5a-07cc-4784-ad71-4c09e4a0b394",
                    "url": "https://api.buildkite.com/v2/organizations/example/agents/51a78a5a-07cc-4784-ad71-4c09e4a0b394",
                    "web_url": "https://buildkite.com/organizations/example/agents/51a78a5a-07cc-4784-ad71-4c09e4a0b394",
                    "name": "buildkite-ci-0f229bba14012b3db",
                    "connection_state": "disconnected",
                    "ip_address": "35.161.192.168",
                    "hostname": "buildkite-ci-0f229bba14012b3db",
                    "user_agent": "buildkite-agent/3.22.1.x (linux; amd64)",
                    "version": "3.22.1",
                    "creator": null,
                    "created_at": "2022-03-08T18:00:46.896Z",
                    "job": null,
                    "last_job_finished_at": "2022-03-08T18:51:27.642Z",
                    "priority": 0,
                    "meta_data": [
                        "queue=v1",
                        "queue=default",
                        "queue=blue-prod",
                        "aws:instance-type=c5.4xlarge",
                        "aws:ami-id=ami-0c03484256f7dde60",
                        "aws:instance-id=i-0f229bba14012b3db",
                        "aws:ec2launchtemplate:id=lt-0f2b1709119aaaaaa",
                        "aws:ec2launchtemplate:version=11",
                        "debug=false",
                        "queues=v1,default,blue-prod",
                        "Name=buildkite-v1-0",
                        "aws:autoscaling:groupName=buildkite-v1-0",
                        "aws:ec2:fleet-id=fleet-d6612e49-5dd7-6833-84b8-8900c9c0b26a",
                        "kind=buildkite",
                        "name=buildkite-v1-0"
                    ]
                },
                "created_at": "2022-03-08T18:15:36.289Z",
                "scheduled_at": "2022-03-08T18:15:36.289Z",
                "runnable_at": "2022-03-08T18:15:36.371Z",
                "started_at": "2022-03-08T18:15:37.813Z",
                "finished_at": "2022-03-08T18:15:51.658Z",
                "retried": false,
                "retried_in_job_id": null,
                "retries_count": null,
                "retry_type": null,
                "parallel_group_index": null,
                "parallel_group_total": null,
                "matrix": null
            },
            {
                "id": "a3774abc-0b4f-4167-aa8f-aab981ce37a8",
                "graphql_id": "Sm9iLS0tYTM3NzRhYmMtMGI0Zi00MTY3LWFhOGYtYWFiOTgxY2UzN2E4",
                "type": "script",
                "name": "test",
                "step_key": null,
                "priority": {
                    "number": 0
                },
                "agent_query_rules": [
                    "queue=v1"
                ],
                "state": "passed",
                "build_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/943",
                "web_url": "https://buildkite.com/example/example_repo/builds/943#a3774abc-0b4f-4167-aa8f-aab981ce37a8",
                "log_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/943/jobs/a3774abc-0b4f-4167-aa8f-aab981ce37a8/log",
                "raw_log_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/943/jobs/a3774abc-0b4f-4167-aa8f-aab981ce37a8/log.txt",
                "artifacts_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/943/jobs/a3774abc-0b4f-4167-aa8f-aab981ce37a8/artifacts",
                "command": "make deps\nmake vendor\nbk-snyk\nmake test\n",
                "soft_failed": false,
                "exit_status": 0,
                "artifact_paths": null,
                "agent": {
                    "id": "4a7b26d8-ded9-40de-86a4-8d42ab6289c6",
                    "url": "https://api.buildkite.com/v2/organizations/example/agents/4a7b26d8-ded9-40de-86a4-8d42ab6289c6",
                    "web_url": "https://buildkite.com/organizations/example/agents/4a7b26d8-ded9-40de-86a4-8d42ab6289c6",
                    "name": "buildkite-ci-058fbac1e17c0d0d9",
                    "connection_state": "connected",
                    "ip_address": "35.161.192.168",
                    "hostname": "buildkite-ci-058fbac1e17c0d0d9",
                    "user_agent": "buildkite-agent/3.22.1.x (linux; amd64)",
                    "version": "3.22.1",
                    "creator": null,
                    "created_at": "2022-03-08T15:48:16.295Z",
                    "job": null,
                    "last_job_finished_at": "2022-03-08T19:02:19.161Z",
                    "priority": 0,
                    "meta_data": [
                        "queue=v1",
                        "queue=default",
                        "queue=blue-prod",
                        "aws:instance-type=c5.4xlarge",
                        "aws:ami-id=ami-0c03484256f7dde60",
                        "aws:instance-id=i-058fbac1e17c0d0d9",
                        "aws:ec2:fleet-id=fleet-decb2ce3-d5d7-c0bb-861a-0188140c9b03",
                        "aws:ec2launchtemplate:version=11",
                        "kind=buildkite",
                        "name=buildkite-v1-0",
                        "queues=v1,default,blue-prod",
                        "Name=buildkite-v1-0",
                        "aws:autoscaling:groupName=buildkite-v1-0",
                        "aws:ec2launchtemplate:id=lt-0f2b1709119aaaaaa",
                        "debug=false"
                    ]
                },
                "created_at": "2022-03-08T18:15:47.821Z",
                "scheduled_at": "2022-03-08T18:15:36.289Z",
                "runnable_at": "2022-03-08T18:15:47.983Z",
                "started_at": "2022-03-08T18:15:57.313Z",
                "finished_at": "2022-03-08T18:17:32.238Z",
                "retried": false,
                "retried_in_job_id": null,
                "retries_count": null,
                "retry_type": null,
                "parallel_group_index": null,
                "parallel_group_total": null,
                "matrix": null
            },
            {
                "id": "24cf1765-f17b-476a-ad62-2fed208dbfe3",
                "graphql_id": "Sm9iLS0tMjRjZjE3NjUtZjE3Yi00NzZhLWFkNjItMmZlZDIwOGRiZmUz",
                "type": "script",
                "name": "publish",
                "step_key": null,
                "priority": {
                    "number": 0
                },
                "agent_query_rules": [
                    "queue=v1"
                ],
                "state": "passed",
                "build_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/943",
                "web_url": "https://buildkite.com/example/example_repo/builds/943#24cf1765-f17b-476a-ad62-2fed208dbfe3",
                "log_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/943/jobs/24cf1765-f17b-476a-ad62-2fed208dbfe3/log",
                "raw_log_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/943/jobs/24cf1765-f17b-476a-ad62-2fed208dbfe3/log.txt",
                "artifacts_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/943/jobs/24cf1765-f17b-476a-ad62-2fed208dbfe3/artifacts",
                "command": "make vendor\nmake publish branch=spancat-ci commit=4416ce9\nmake publish branch=spancat-ci commit=4416ce9 tags=debug\nbuildkite-agent annotate \"Image: $(make image branch=spancat-ci commit=4416ce9)\" --style 'success' --context 'ctx-success'\nbuildkite-agent annotate \"Debug image: $(make image branch=spancat-ci commit=4416ce9 tags=debug)\" --style 'info' --context 'ctx-success'\n",
                "soft_failed": false,
                "exit_status": 0,
                "artifact_paths": null,
                "agent": {
                    "id": "1040444a-9a68-4cac-9bf2-68a18bec105c",
                    "url": "https://api.buildkite.com/v2/organizations/example/agents/1040444a-9a68-4cac-9bf2-68a18bec105c",
                    "web_url": "https://buildkite.com/organizations/example/agents/1040444a-9a68-4cac-9bf2-68a18bec105c",
                    "name": "buildkite-ci-023a6c122a0335a5f",
                    "connection_state": "connected",
                    "ip_address": "35.161.192.168",
                    "hostname": "buildkite-ci-023a6c122a0335a5f",
                    "user_agent": "buildkite-agent/3.22.1.x (linux; amd64)",
                    "version": "3.22.1",
                    "creator": null,
                    "created_at": "2022-03-08T17:23:15.037Z",
                    "job": null,
                    "last_job_finished_at": "2022-03-08T19:03:56.303Z",
                    "priority": 0,
                    "meta_data": [
                        "queue=v1",
                        "queue=default",
                        "queue=blue-prod",
                        "aws:instance-type=c5.4xlarge",
                        "aws:ami-id=ami-0c03484256f7dde60",
                        "aws:instance-id=i-023a6c122a0335a5f",
                        "aws:autoscaling:groupName=buildkite-v1-0",
                        "Name=buildkite-v1-0",
                        "aws:ec2:fleet-id=fleet-dcc92463-75df-409b-8eb0-29a28c2618c8",
                        "aws:ec2launchtemplate:id=lt-0f2b1709119aaaaaa",
                        "aws:ec2launchtemplate:version=11",
                        "debug=false",
                        "kind=buildkite",
                        "name=buildkite-v1-0",
                        "queues=v1,default,blue-prod"
                    ]
                },
                "created_at": "2022-03-08T18:15:47.821Z",
                "scheduled_at": "2022-03-08T18:15:36.289Z",
                "runnable_at": "2022-03-08T18:15:47.983Z",
                "started_at": "2022-03-08T18:15:56.179Z",
                "finished_at": "2022-03-08T18:17:35.967Z",
                "retried": false,
                "retried_in_job_id": null,
                "retries_count": null,
                "retry_type": null,
                "parallel_group_index": null,
                "parallel_group_total": null,
                "matrix": null
            }
        ]
    },
    {
        "id": "8cdf262f-eee4-4131-a42a-c5f717dedd38",
        "graphql_id": "QnVpbGQtLS04Y2RmMjYyZi1lZWU0LTQxMzEtYTQyYS1jNWY3MTdkZWRkMzg=",
        "url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/942",
        "web_url": "https://buildkite.com/example/example_repo/builds/942",
        "number": 942,
        "state": "passed",
        "blocked": false,
        "blocked_state": "",
        "message": "tracedb: fix spelling mistakes",
        "commit": "4191d6c81c7ad9e247a238a23c4d3f233d83472e",
        "branch": "master",
        "tag": null,
        "env": {},
        "source": "webhook",
        "author": {
            "username": "kevinburkeexample",
            "name": "Kevin Burke",
            "email": "kevin.burke@example.com"
        },
        "creator": {
            "id": "96ba0039-c9f3-45bb-8039-23705197a20d",
            "graphql_id": "VXNlci0tLTk2YmEwMDM5LWM5ZjMtNDViYi04MDM5LTIzNzA1MTk3YTIwZA==",
            "name": "Kevin Burke",
            "email": "kevin.burke@example.com",
            "avatar_url": "https://www.gravatar.com/avatar/b6fb7afdae89b8470c0bed5b5ea7156c",
            "created_at": "2021-12-15T22:37:55.752Z"
        },
        "created_at": "2022-03-08T18:15:25.291Z",
        "scheduled_at": "2022-03-08T18:15:25.236Z",
        "started_at": "2022-03-08T18:15:28.352Z",
        "finished_at": "2022-03-08T18:17:21.157Z",
        "meta_data": {
            "buildkite:git:commit": "commit 4191d6c81c7ad9e247a238a23c4d3f233d83472e\nAuthor:     Kevin Burke <kevin.burke@example.com>\nAuthorDate: Wed Feb 23 16:37:24 2022 -0800\nCommit:     Kevin Burke <kevin.burke@example.com>\nCommitDate: Tue Mar 8 10:10:07 2022 -0800\n\n    tracedb: fix spelling mistakes"
        },
        "pull_request": null,
        "rebuilt_from": null,
        "pipeline": {
            "id": "632fa93f-af7b-4bbb-a2be-58f1f6f18300",
            "graphql_id": "UGlwZWxpbmUtLS02MzJmYTkzZi1hZjdiLTRiYmItYTJiZS01OGYxZjZmMTgzMDA=",
            "url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo",
            "web_url": "https://buildkite.com/example/example_repo",
            "name": "example_repo",
            "description": null,
            "slug": "example_repo",
            "repository": "git@github.com:example/example_repo.git",
            "cluster_id": null,
            "branch_configuration": null,
            "default_branch": "master",
            "skip_queued_branch_builds": false,
            "skip_queued_branch_builds_filter": null,
            "cancel_running_branch_builds": false,
            "cancel_running_branch_builds_filter": null,
            "allow_rebuilds": true,
            "provider": {
                "id": "github",
                "settings": {
                    "trigger_mode": "code",
                    "build_pull_requests": true,
                    "pull_request_branch_filter_enabled": false,
                    "skip_builds_for_existing_commits": false,
                    "skip_pull_request_builds_for_existing_commits": true,
                    "build_pull_request_ready_for_review": false,
                    "build_pull_request_labels_changed": false,
                    "build_pull_request_forks": false,
                    "prefix_pull_request_fork_branch_names": true,
                    "build_branches": true,
                    "build_tags": false,
                    "cancel_deleted_branch_builds": false,
                    "publish_commit_status": true,
                    "publish_commit_status_per_step": false,
                    "separate_pull_request_statuses": false,
                    "publish_blocked_as_pending": false,
                    "use_step_key_as_commit_status": false,
                    "filter_enabled": false,
                    "repository": "example/example_repo"
                },
                "webhook_url": "https://webhook.buildkite.com/deliver/a8b7d1ec0e383c14108b9d814c76173fe17da74ae1f35a5f0c"
            },
            "builds_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds",
            "badge_url": "https://badge.buildkite.com/7d154fae54d51f386ce4db0a5f1194690e614425ea9f3726ba.svg",
            "created_by": {
                "id": "52ddcfda-658d-404a-b2d2-b006f3c7a2ad",
                "graphql_id": "VXNlci0tLTUyZGRjZmRhLTY1OGQtNDA0YS1iMmQyLWIwMDZmM2M3YTJhZA==",
                "name": "Buildkite Bot",
                "email": "tooling-team+buildkite-bot@example.com",
                "avatar_url": "https://www.gravatar.com/avatar/f802d3f82304aaebaed6d934e9ce231c",
                "created_at": "2019-06-26T00:02:51.775Z"
            },
            "created_at": "2020-07-28T23:16:52.812Z",
            "archived_at": null,
            "env": {},
            "scheduled_builds_count": 0,
            "running_builds_count": 1,
            "scheduled_jobs_count": 0,
            "running_jobs_count": 2,
            "waiting_jobs_count": 0,
            "visibility": "private",
            "tags": null,
            "steps": [
                {
                    "type": "script",
                    "name": ":pipeline:",
                    "command": "buildkite-agent pipeline upload",
                    "artifact_paths": null,
                    "branch_configuration": null,
                    "env": {},
                    "timeout_in_minutes": null,
                    "agent_query_rules": [],
                    "concurrency": null,
                    "parallelism": null
                }
            ]
        },
        "jobs": [
            {
                "id": "b95ea516-9928-4cd5-9c9d-cb6858d69085",
                "graphql_id": "Sm9iLS0tYjk1ZWE1MTYtOTkyOC00Y2Q1LTljOWQtY2I2ODU4ZDY5MDg1",
                "type": "script",
                "name": ":pipeline:",
                "step_key": null,
                "priority": {
                    "number": 0
                },
                "agent_query_rules": [],
                "state": "passed",
                "build_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/942",
                "web_url": "https://buildkite.com/example/example_repo/builds/942#b95ea516-9928-4cd5-9c9d-cb6858d69085",
                "log_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/942/jobs/b95ea516-9928-4cd5-9c9d-cb6858d69085/log",
                "raw_log_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/942/jobs/b95ea516-9928-4cd5-9c9d-cb6858d69085/log.txt",
                "artifacts_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/942/jobs/b95ea516-9928-4cd5-9c9d-cb6858d69085/artifacts",
                "command": "buildkite-agent pipeline upload",
                "soft_failed": false,
                "exit_status": 0,
                "artifact_paths": null,
                "agent": {
                    "id": "7fe65946-ecfc-4426-9469-e3d5b0e55b4b",
                    "url": "https://api.buildkite.com/v2/organizations/example/agents/7fe65946-ecfc-4426-9469-e3d5b0e55b4b",
                    "web_url": "https://buildkite.com/organizations/example/agents/7fe65946-ecfc-4426-9469-e3d5b0e55b4b",
                    "name": "buildkite-ci-095c35ea8780c437b",
                    "connection_state": "disconnected",
                    "ip_address": "35.161.192.168",
                    "hostname": "buildkite-ci-095c35ea8780c437b",
                    "user_agent": "buildkite-agent/3.22.1.x (linux; amd64)",
                    "version": "3.22.1",
                    "creator": null,
                    "created_at": "2022-03-08T16:20:07.106Z",
                    "job": null,
                    "last_job_finished_at": "2022-03-08T18:38:19.834Z",
                    "priority": 0,
                    "meta_data": [
                        "queue=v1",
                        "queue=default",
                        "queue=blue-prod",
                        "aws:instance-id=i-095c35ea8780c437b",
                        "aws:instance-type=c5.4xlarge",
                        "aws:ami-id=ami-0c03484256f7dde60",
                        "name=buildkite-v1-0",
                        "queues=v1,default,blue-prod",
                        "aws:ec2:fleet-id=fleet-54c30441-dd5d-6039-863a-a1a861071894",
                        "aws:ec2launchtemplate:id=lt-0f2b1709119aaaaaa",
                        "aws:ec2launchtemplate:version=11",
                        "kind=buildkite",
                        "Name=buildkite-v1-0",
                        "aws:autoscaling:groupName=buildkite-v1-0",
                        "debug=false"
                    ]
                },
                "created_at": "2022-03-08T18:15:25.264Z",
                "scheduled_at": "2022-03-08T18:15:25.264Z",
                "runnable_at": "2022-03-08T18:15:25.349Z",
                "started_at": "2022-03-08T18:15:28.352Z",
                "finished_at": "2022-03-08T18:15:41.417Z",
                "retried": false,
                "retried_in_job_id": null,
                "retries_count": null,
                "retry_type": null,
                "parallel_group_index": null,
                "parallel_group_total": null,
                "matrix": null
            },
            {
                "id": "1a05f51d-8449-4e80-a1b5-a264639ee830",
                "graphql_id": "Sm9iLS0tMWEwNWY1MWQtODQ0OS00ZTgwLWExYjUtYTI2NDYzOWVlODMw",
                "type": "script",
                "name": "test",
                "step_key": null,
                "priority": {
                    "number": 0
                },
                "agent_query_rules": [
                    "queue=v1"
                ],
                "state": "passed",
                "build_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/942",
                "web_url": "https://buildkite.com/example/example_repo/builds/942#1a05f51d-8449-4e80-a1b5-a264639ee830",
                "log_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/942/jobs/1a05f51d-8449-4e80-a1b5-a264639ee830/log",
                "raw_log_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/942/jobs/1a05f51d-8449-4e80-a1b5-a264639ee830/log.txt",
                "artifacts_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/942/jobs/1a05f51d-8449-4e80-a1b5-a264639ee830/artifacts",
                "command": "make deps\nmake vendor\nbk-snyk\nmake test\n",
                "soft_failed": false,
                "exit_status": 0,
                "artifact_paths": null,
                "agent": {
                    "id": "769417cd-b250-4768-bc40-88a9b1cfc680",
                    "url": "https://api.buildkite.com/v2/organizations/example/agents/769417cd-b250-4768-bc40-88a9b1cfc680",
                    "web_url": "https://buildkite.com/organizations/example/agents/769417cd-b250-4768-bc40-88a9b1cfc680",
                    "name": "buildkite-ci-00d5adc72422aaa72",
                    "connection_state": "lost",
                    "ip_address": "35.161.192.168",
                    "hostname": "buildkite-ci-00d5adc72422aaa72",
                    "user_agent": "buildkite-agent/3.22.1.x (linux; amd64)",
                    "version": "3.22.1",
                    "creator": null,
                    "created_at": "2022-03-08T15:43:34.285Z",
                    "job": null,
                    "last_job_finished_at": "2022-03-08T18:23:02.534Z",
                    "priority": 0,
                    "meta_data": [
                        "queue=v1",
                        "queue=default",
                        "queue=green-prod",
                        "aws:instance-id=i-00d5adc72422aaa72",
                        "aws:instance-type=c5.4xlarge",
                        "aws:ami-id=ami-0c03484256f7dde60",
                        "aws:ec2launchtemplate:version=4",
                        "debug=false",
                        "queues=v1,default,green-prod",
                        "Name=buildkite-v1-green-0",
                        "aws:autoscaling:groupName=buildkite-v1-green-0",
                        "aws:ec2:fleet-id=fleet-5ec3a6cb-5ff5-4a19-0692-290086fc65c7",
                        "aws:ec2launchtemplate:id=lt-00d7f6fc105994097",
                        "kind=buildkite",
                        "name=buildkite-v1-green-0"
                    ]
                },
                "created_at": "2022-03-08T18:15:37.539Z",
                "scheduled_at": "2022-03-08T18:15:25.264Z",
                "runnable_at": "2022-03-08T18:15:37.620Z",
                "started_at": "2022-03-08T18:15:45.126Z",
                "finished_at": "2022-03-08T18:17:06.802Z",
                "retried": false,
                "retried_in_job_id": null,
                "retries_count": null,
                "retry_type": null,
                "parallel_group_index": null,
                "parallel_group_total": null,
                "matrix": null
            },
            {
                "id": "dce09438-fe14-4591-9a1a-3d8598805a73",
                "graphql_id": "Sm9iLS0tZGNlMDk0MzgtZmUxNC00NTkxLTlhMWEtM2Q4NTk4ODA1YTcz",
                "type": "script",
                "name": "publish",
                "step_key": null,
                "priority": {
                    "number": 0
                },
                "agent_query_rules": [
                    "queue=v1"
                ],
                "state": "passed",
                "build_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/942",
                "web_url": "https://buildkite.com/example/example_repo/builds/942#dce09438-fe14-4591-9a1a-3d8598805a73",
                "log_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/942/jobs/dce09438-fe14-4591-9a1a-3d8598805a73/log",
                "raw_log_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/942/jobs/dce09438-fe14-4591-9a1a-3d8598805a73/log.txt",
                "artifacts_url": "https://api.buildkite.com/v2/organizations/example/pipelines/example_repo/builds/942/jobs/dce09438-fe14-4591-9a1a-3d8598805a73/artifacts",
                "command": "make vendor\nmake publish branch=master commit=4191d6c\nmake publish branch=master commit=4191d6c tags=debug\nbuildkite-agent annotate \"Image: $(make image branch=master commit=4191d6c)\" --style 'success' --context 'ctx-success'\nbuildkite-agent annotate \"Debug image: $(make image branch=master commit=4191d6c tags=debug)\" --style 'info' --context 'ctx-success'\n",
                "soft_failed": false,
                "exit_status": 0,
                "artifact_paths": null,
                "agent": {
                    "id": "4bfc8aea-94f4-4ef4-a5cd-6ac3b713dc93",
                    "url": "https://api.buildkite.com/v2/organizations/example/agents/4bfc8aea-94f4-4ef4-a5cd-6ac3b713dc93",
                    "web_url": "https://buildkite.com/organizations/example/agents/4bfc8aea-94f4-4ef4-a5cd-6ac3b713dc93",
                    "name": "buildkite-ci-0c2ce33582ef1613d",
                    "connection_state": "connected",
                    "ip_address": "35.161.192.168",
                    "hostname": "buildkite-ci-0c2ce33582ef1613d",
                    "user_agent": "buildkite-agent/3.22.1.x (linux; amd64)",
                    "version": "3.22.1",
                    "creator": null,
                    "created_at": "2022-03-08T17:03:51.129Z",
                    "job": null,
                    "last_job_finished_at": "2022-03-08T19:12:35.186Z",
                    "priority": 0,
                    "meta_data": [
                        "queue=v1",
                        "queue=default",
                        "queue=blue-prod",
                        "aws:instance-type=c5.4xlarge",
                        "aws:ami-id=ami-0c03484256f7dde60",
                        "aws:instance-id=i-0c2ce33582ef1613d",
                        "queues=v1,default,blue-prod",
                        "Name=buildkite-v1-0",
                        "aws:autoscaling:groupName=buildkite-v1-0",
                        "aws:ec2:fleet-id=fleet-d64b8469-f557-4a99-0cb2-a902344c4b23",
                        "aws:ec2launchtemplate:version=11",
                        "debug=false",
                        "name=buildkite-v1-0",
                        "aws:ec2launchtemplate:id=lt-0f2b1709119aaaaaa",
                        "kind=buildkite"
                    ]
                },
                "created_at": "2022-03-08T18:15:37.539Z",
                "scheduled_at": "2022-03-08T18:15:25.264Z",
                "runnable_at": "2022-03-08T18:15:37.620Z",
                "started_at": "2022-03-08T18:15:42.212Z",
                "finished_at": "2022-03-08T18:17:20.928Z",
                "retried": false,
                "retried_in_job_id": null,
                "retries_count": null,
                "retry_type": null,
                "parallel_group_index": null,
                "parallel_group_total": null,
                "matrix": null
            }
        ]
    }
]
`)

var logResponse = []byte(`
{
    "url": "https://api.buildkite.com/v2/organizations/segment/pipelines/tracing/builds/944/jobs/fca912da-fe38-4bf5-b8df-980ce0367aff/log",
    "content": "~~~ buildkite bootstrap\r\nFetching credentials for role with ARN arn:aws:iam::528451384384:role/buildkite-agent\r\nExporting credentials (assumed role ARN arn:aws:sts::528451384384:assumed-role/buildkite-agent/buildkite-tracing-build-944)\r\nWARNING! Using --password via the CLI is insecure. Use --password-stdin.\r\nWARNING! Your password will be stored unencrypted in /var/lib/buildkite-agent/.docker/config.json.\r\nConfigure a credential helper to remove this warning. See\r\nhttps://docs.docker.com/engine/reference/commandline/login/#credentials-store\r\n\r\nLogin Succeeded\r\npulling down image: 528451384384.dkr.ecr.us-west-2.amazonaws.com/buildkite-agent:latest\r\nlatest: Pulling from buildkite-agent\r\nDigest: sha256:5190bb6ec68d2f4394db5daa1141f1a06845bfe7c4f3c3c8912fa65a769c150f\r\nStatus: Image is up to date for 528451384384.dkr.ecr.us-west-2.amazonaws.com/buildkite-agent:latest\r\n528451384384.dkr.ecr.us-west-2.amazonaws.com/buildkite-agent:latest\r\nClearing credentials (AWS_ASSUMED_ROLE_ARN: arn:aws:sts::528451384384:assumed-role/buildkite-agent/buildkite-tracing-build-944)\r\nBuild running in :docker: 528451384384.dkr.ecr.us-west-2.amazonaws.com/buildkite-agent:latest\r\n\u001b[90m$\u001b[0m docker run --rm--envAWS_ACCESS_KEY_ID--envAWS_SECRET_ACCESS_KEY--envAWS_REGION--envAWS_DEFAULT_REGION--envAWS_SESSION_TOKEN--envAWS_SECURITY_TOKEN--envBUILDKITE_ENV_FILE--envBUILDKITE_AGENT_ACCESS_TOKEN--envBUILDKITE_AGENT_BINARY_PATH--envBUILDKITE_AGENT_DEBUG=false--envBUILDKITE_BUILD_PATH=/var/lib/buildkite-agent/builds--envBUILDKITE_PLUGINS_PATH=/etc/buildkite-agent/plugins--envBUILDKITE_HOOKS_PATH=/etc/buildkite-agent/buildkite-hooks/hooks--volume/etc/passwd:/etc/passwd:ro--volume/etc/group:/etc/group:ro--volume/etc/buildkite-agent/plugins:/etc/buildkite-agent/plugins--volume/var/lib/buildkite-agent/.docker:/var/lib/buildkite-agent/.docker--volume/var/lib/buildkite-agent/.ssh:/var/lib/buildkite-agent/.ssh--volume/var/lib/buildkite-agent/.tmp:/tmp--volume/var/lib/buildkite-agent/builds:/var/lib/buildkite-agent/builds--volume/var/run/docker.sock:/var/run/docker.sock--user1001:1001--group-add999--entrypoint/usr/local/bin/buildkite-agent--security-opt=no-new-privileges--networkhost--namebuildkite-agent-job-fca912da-fe38-4bf5-b8df-980ce0367aff--envBUILDKITE_RETRY_COUNT--envBUILDKITE_TAG--envBUILDKITE_ARTIFACT_PATHS--envBUILDKITE_TRIGGERED_FROM_BUILD_ID--envBUILDKITE_TRIGGERED_FROM_BUILD_NUMBER--envBUILDKITE_TRIGGERED_FROM_BUILD_PIPELINE_SLUG--envBUILDKITE_PIPELINE_ID--envBUILDKITE_AGENT_META_DATA_AWS_EC2_FLEET_ID--envBUILDKITE_PIPELINE_SLUG--envBUILDKITE_BUILD_CREATOR_EMAIL--envBUILDKITE_REBUILT_FROM_BUILD_NUMBER--envBUILDKITE_REPO_SSH_HOST--envBUILDKITE_BUILD_CREATOR--envBUILDKITE_PIPELINE_NAME--envBUILDKITE_AGENT_NAME--envBUILDKITE_PULL_REQUEST_BASE_BRANCH--envBUILDKITE_BUILD_URL--envBUILDKITE_STEP_ID--envBUILDKITE_AGENT_META_DATA_AWS_INSTANCE_ID--envBUILDKITE_BUILD_AUTHOR--envBUILDKITE_MESSAGE--envBUILDKITE_PROJECT_PROVIDER--envBUILDKITE_COMMIT--envBUILDKITE_PIPELINE_DEFAULT_BRANCH--envBUILDKITE_AGENT_META_DATA_QUEUES--envBUILDKITE_AGENT_META_DATA_AWS_EC2LAUNCHTEMPLATE_ID--envBUILDKITE_AGENT_META_DATA_AWS_AMI_ID--envBUILDKITE_AGENT_META_DATA_DEBUG--envBUILDKITE_PROJECT_SLUG--envBUILDKITE_COMMAND--envBUILDKITE_REBUILT_FROM_BUILD_ID--envBUILDKITE_AGENT_META_DATA_AWS_AUTOSCALING_GROUPNAME--envBUILDKITE_BUILD_CREATOR_TEAMS--envBUILDKITE_AGENT_META_DATA_AWS_INSTANCE_TYPE--envBUILDKITE_AGENT_ID--envBUILDKITE--envBUILDKITE_STEP_KEY--envBUILDKITE_PULL_REQUEST_REPO--envBUILDKITE_PIPELINE_PROVIDER--envBUILDKITE_SOURCE--envBUILDKITE_AGENT_META_DATA_AWS_EC2LAUNCHTEMPLATE_VERSION--envCI--envBUILDKITE_SCRIPT_PATH--envBUILDKITE_PULL_REQUEST--envBUILDKITE_LABEL--envBUILDKITE_REPO--envBUILDKITE_TIMEOUT--envBUILDKITE_BUILD_AUTHOR_EMAIL--envBUILDKITE_JOB_ID--envBUILDKITE_BUILD_ID--envBUILDKITE_BUILD_NUMBER--envBUILDKITE_ORGANIZATION_SLUG--envBUILDKITE_BRANCH--envBUILDKITE_AGENT_META_DATA_NAME--envBUILDKITE_AGENT_META_DATA_KIND--envBUILDKITE_AGENT_META_DATA_QUEUE528451384384.dkr.ecr.us-west-2.amazonaws.com/buildkite-agent:latestbootstrap--debug\r\n~~~ Buildkite environment variables\r\nBUILDKITE=true\r\nBUILDKITE_AGENT_ACCESS_TOKEN=******************\r\nBUILDKITE_AGENT_BINARY_PATH=/var/lib/buildkite-agent/bin/buildkite-agent\r\nBUILDKITE_AGENT_DEBUG=false\r\nBUILDKITE_AGENT_ID=ea21056f-2e4f-45e2-af25-6a184c30cc3e\r\nBUILDKITE_AGENT_META_DATA_AWS_AMI_ID=ami-0c03484256f7dde60\r\nBUILDKITE_AGENT_META_DATA_AWS_AUTOSCALING_GROUPNAME=buildkite-v1-green-0\r\nBUILDKITE_AGENT_META_DATA_AWS_EC2LAUNCHTEMPLATE_ID=lt-00d7f6fc105994097\r\nBUILDKITE_AGENT_META_DATA_AWS_EC2LAUNCHTEMPLATE_VERSION=4\r\nBUILDKITE_AGENT_META_DATA_AWS_EC2_FLEET_ID=fleet-f6cba4e3-57d7-ea11-a41a-830226b1deab\r\nBUILDKITE_AGENT_META_DATA_AWS_INSTANCE_ID=i-033404905f9532bfd\r\nBUILDKITE_AGENT_META_DATA_AWS_INSTANCE_TYPE=c5.4xlarge\r\nBUILDKITE_AGENT_META_DATA_DEBUG=false\r\nBUILDKITE_AGENT_META_DATA_KIND=buildkite\r\nBUILDKITE_AGENT_META_DATA_NAME=buildkite-v1-green-0,buildkite-v1-green-0\r\nBUILDKITE_AGENT_META_DATA_QUEUE=v1,default,green-prod\r\nBUILDKITE_AGENT_META_DATA_QUEUES=v1,default,green-prod\r\nBUILDKITE_AGENT_NAME=buildkite-ci-033404905f9532bfd\r\nBUILDKITE_ARTIFACT_PATHS=\r\nBUILDKITE_BRANCH=master\r\nBUILDKITE_BUILD_AUTHOR=Kevin Burke\r\nBUILDKITE_BUILD_AUTHOR_EMAIL=kevin.burke@segment.com\r\nBUILDKITE_BUILD_CHECKOUT_PATH=/var/lib/buildkite-agent/builds/buildkite-ci-033404905f9532bfd/segment/tracing\r\nBUILDKITE_BUILD_CREATOR=Kevin Burke\r\nBUILDKITE_BUILD_CREATOR_EMAIL=kevin.burke@segment.com\r\nBUILDKITE_BUILD_CREATOR_TEAMS=everyone\r\nBUILDKITE_BUILD_ID=071e0979-8671-4904-be5a-0b18fb5ba09b\r\nBUILDKITE_BUILD_NUMBER=944\r\nBUILDKITE_BUILD_PATH=/var/lib/buildkite-agent/builds\r\nBUILDKITE_BUILD_URL=https://buildkite.com/segment/tracing/builds/944\r\nBUILDKITE_COMMAND=buildkite-agent pipeline upload\r\nBUILDKITE_COMMIT=4416ce9a1bbd38505c72f8f9d034a45c41b02a02\r\nBUILDKITE_ENV_FILE=/tmp/job-env-fca912da-fe38-4bf5-b8df-980ce0367aff272341958\r\nBUILDKITE_HOOKS_PATH=/etc/buildkite-agent/buildkite-hooks/hooks\r\nBUILDKITE_JOB_ID=fca912da-fe38-4bf5-b8df-980ce0367aff\r\nBUILDKITE_LABEL=:pipeline:\r\nBUILDKITE_MESSAGE=span/kafka: skip tests with offline Kafka server\\n\\nThese tests cause CI failures when we ask the CI environment to run\\nthe spancat tests.\\n\\nFixes #166.\r\nBUILDKITE_ORGANIZATION_SLUG=segment\r\nBUILDKITE_PIPELINE_DEFAULT_BRANCH=master\r\nBUILDKITE_PIPELINE_ID=632fa93f-af7b-4bbb-a2be-58f1f6f18300\r\nBUILDKITE_PIPELINE_NAME=tracing\r\nBUILDKITE_PIPELINE_PROVIDER=github\r\nBUILDKITE_PIPELINE_SLUG=tracing\r\nBUILDKITE_PLUGINS_PATH=/etc/buildkite-agent/plugins\r\nBUILDKITE_PROJECT_PROVIDER=github\r\nBUILDKITE_PROJECT_SLUG=segment/tracing\r\nBUILDKITE_PULL_REQUEST=false\r\nBUILDKITE_PULL_REQUEST_BASE_BRANCH=\r\nBUILDKITE_PULL_REQUEST_REPO=\r\nBUILDKITE_REBUILT_FROM_BUILD_ID=\r\nBUILDKITE_REBUILT_FROM_BUILD_NUMBER=\r\nBUILDKITE_REPO=git@github.com:segmentio/tracing.git\r\nBUILDKITE_REPO_SSH_HOST=github.com\r\nBUILDKITE_RETRY_COUNT=0\r\nBUILDKITE_SCRIPT_PATH=buildkite-agent pipeline upload\r\nBUILDKITE_SOURCE=webhook\r\nBUILDKITE_STEP_ID=92c3393e-92f5-4913-9666-2b5a8d7d0e1e\r\nBUILDKITE_STEP_KEY=\r\nBUILDKITE_TAG=\r\nBUILDKITE_TIMEOUT=false\r\nBUILDKITE_TRIGGERED_FROM_BUILD_ID=\r\nBUILDKITE_TRIGGERED_FROM_BUILD_NUMBER=\r\nBUILDKITE_TRIGGERED_FROM_BUILD_PIPELINE_SLUG=\r\nCI=true\r\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/go/bin:/home/buildkite-agent/.local/bin\r\n~~~ Running global environment hook\r\n\u001b[90m# A hook runner was written to \"/tmp/buildkite-agent-bootstrap-hook-runner-122477727\" with the following:\u001b[0m\r\n\u001b[90m$\u001b[0m /tmp/buildkite-agent-bootstrap-hook-runner-122477727\r\n2022/03/08 19:16:01 stats/datadog: sending metrics with a buffer of size 1024 B\r\r\n2022/03/08 19:16:01 Successfully generated github access token with expiration at 2022-03-08 20:16:01 +0000 UTC\r\r\nWARNING! Your password will be stored unencrypted in /var/lib/buildkite-agent/.docker/config.json.\r\r\nConfigure a credential helper to remove this warning. See\r\r\nhttps://docs.docker.com/engine/reference/commandline/login/#credentials-store\r\r\n\r\r\nLogin Succeeded\r\r\n\u001b[90m# \u21b3 Command completed in 4.604503674s\u001b[0m\r\n\u001b[90m# SEGMENT_LIB_PATH changed\u001b[0m\r\n\u001b[90m# GITHUB_TOKEN changed\u001b[0m\r\n\u001b[90m# PACKAGECLOUD_TOKEN changed\u001b[0m\r\n\u001b[90m# BUILDKITE_S3_DEFAULT_REGION changed\u001b[0m\r\n\u001b[90m# SEGMENT_HOOKS_PATH changed\u001b[0m\r\n\u001b[90m# BUILDKITE_JOB_LOCAL_NETRC changed\u001b[0m\r\n\u001b[90m# BUILDKITE_ARTIFACT_UPLOAD_DESTINATION is now \"s3://segment-buildkite-artifacts/fca912da-fe38-4bf5-b8df-980ce0367aff\"\u001b[0m\r\n\u001b[90m# SSH_IDENTITY changed\u001b[0m\r\n\u001b[90m# BUILDKITE_PLUGIN_DOCKER_PROPAGATE_ENVIRONMENT changed\u001b[0m\r\n\u001b[90m# BUILDKITE_PLUGIN_DOCKER_MOUNT_SSH_AGENT changed\u001b[0m\r\n\u001b[90m# BUILDKITE_PLUGIN_DOCKER_VOLUMES_0 changed\u001b[0m\r\n\u001b[90m# TREB_TOKEN changed\u001b[0m\r\n\u001b[90m# BUILDKITE_S3_ACL changed\u001b[0m\r\n\u001b[90m# BUILDKITE_JOB_HOST_NETRC changed\u001b[0m\r\n\u001b[90m# ECR_REPOSITORY changed\u001b[0m\r\n\u001b[90m# BUILDKITE_PLUGIN_DOCKER_ENVIRONMENT_0 changed\u001b[0m\r\n\u001b[90m# BUILDKITE_PLUGIN_DOCKER_ENVIRONMENT_1 changed\u001b[0m\r\n\u001b[90m# GOPRIVATE changed\u001b[0m\r\n\u001b[90m# SSH_AUTH_SOCK changed\u001b[0m\r\n\u001b[90m# BUILDKITE_PLUGIN_CACHE_S3_BUCKET_NAME changed\u001b[0m\r\n\u001b[90m# NETRC changed\u001b[0m\r\n\u001b[90m# SRC_ACCESS_TOKEN changed\u001b[0m\r\n\u001b[90m# ECR_ACCOUNT_ID changed\u001b[0m\r\n\u001b[90m# Skipping plugin phase\u001b[0m\r\n~~~ Running global pre-checkout hook\r\n\u001b[90m# A hook runner was written to \"/tmp/buildkite-agent-bootstrap-hook-runner-976992116\" with the following:\u001b[0m\r\n\u001b[90m$\u001b[0m /tmp/buildkite-agent-bootstrap-hook-runner-976992116\r\n\u001b[90m# \u21b3 Command completed in 5.21027ms\u001b[0m\r\n~~~ Preparing working directory\r\n\u001b[90m# Creating \"/var/lib/buildkite-agent/builds/buildkite-ci-033404905f9532bfd/segment/tracing\"\u001b[0m\r\n\u001b[90m$\u001b[0m cd /var/lib/buildkite-agent/builds/buildkite-ci-033404905f9532bfd/segment/tracing\r\n\u001b[90m$\u001b[0m ssh -G github.com\r\nPseudo-terminal will not be allocated because stdin is not a terminal.\r\r\n\u001b[90m# \u21b3 Command completed in 3.804571ms\u001b[0m\r\n\u001b[90m# Host \"github.com\" already in list of known hosts at \"/var/lib/buildkite-agent/.ssh/known_hosts\"\u001b[0m\r\n\u001b[90m$\u001b[0m git clone -v -- git@github.com:segmentio/tracing.git .\r\nCloning into '.'...\r\r\nremote: Enumerating objects: 5989, done.\u001b[K\r\r\nremote: Counting objects:   0% (1/2610)\u001b[K\rremote: Counting objects:   1% (27/2610)\u001b[K\rremote: Counting objects:   2% (53/2610)\u001b[K\rremote: Counting objects:   3% (79/2610)\u001b[K\rremote: Counting objects:   4% (105/2610)\u001b[K\rremote: Counting objects:   5% (131/2610)\u001b[K\rremote: Counting objects:   6% (157/2610)\u001b[K\rremote: Counting objects:   7% (183/2610)\u001b[K\rremote: Counting objects:   8% (209/2610)\u001b[K\rremote: Counting objects:   9% (235/2610)\u001b[K\rremote: Counting objects:  10% (261/2610)\u001b[K\rremote: Counting objects:  11% (288/2610)\u001b[K\rremote: Counting objects:  12% (314/2610)\u001b[K\rremote: Counting objects:  13% (340/2610)\u001b[K\rremote: Counting objects:  14% (366/2610)\u001b[K\rremote: Counting objects:  15% (392/2610)\u001b[K\rremote: Counting objects:  16% (418/2610)\u001b[K\rremote: Counting objects:  17% (444/2610)\u001b[K\rremote: Counting objects:  18% (470/2610)\u001b[K\rremote: Counting objects:  19% (496/2610)\u001b[K\rremote: Counting objects:  20% (522/2610)\u001b[K\rremote: Counting objects:  21% (549/2610)\u001b[K\rremote: Counting objects:  22% (575/2610)\u001b[K\rremote: Counting objects:  23% (601/2610)\u001b[K\rremote: Counting objects:  24% (627/2610)\u001b[K\rremote: Counting objects:  25% (653/2610)\u001b[K\rremote: Counting objects:  26% (679/2610)\u001b[K\rremote: Counting objects:  27% (705/2610)\u001b[K\rremote: Counting objects:  28% (731/2610)\u001b[K\rremote: Counting objects:  29% (757/2610)\u001b[K\rremote: Counting objects:  30% (783/2610)\u001b[K\rremote: Counting objects:  31% (810/2610)\u001b[K\rremote: Counting objects:  32% (836/2610)\u001b[K\rremote: Counting objects:  33% (862/2610)\u001b[K\rremote: Counting objects:  34% (888/2610)\u001b[K\rremote: Counting objects:  35% (914/2610)\u001b[K\rremote: Counting objects:  36% (940/2610)\u001b[K\rremote: Counting objects:  37% (966/2610)\u001b[K\rremote: Counting objects:  38% (992/2610)\u001b[K\rremote: Counting objects:  39% (1018/2610)\u001b[K\rremote: Counting objects:  40% (1044/2610)\u001b[K\rremote: Counting objects:  41% (1071/2610)\u001b[K\rremote: Counting objects:  42% (1097/2610)\u001b[K\rremote: Counting objects:  43% (1123/2610)\u001b[K\rremote: Counting objects:  44% (1149/2610)\u001b[K\rremote: Counting objects:  45% (1175/2610)\u001b[K\rremote: Counting objects:  46% (1201/2610)\u001b[K\rremote: Counting objects:  47% (1227/2610)\u001b[K\rremote: Counting objects:  48% (1253/2610)\u001b[K\rremote: Counting objects:  49% (1279/2610)\u001b[K\rremote: Counting objects:  50% (1305/2610)\u001b[K\rremote: Counting objects:  51% (1332/2610)\u001b[K\rremote: Counting objects:  52% (1358/2610)\u001b[K\rremote: Counting objects:  53% (1384/2610)\u001b[K\rremote: Counting objects:  54% (1410/2610)\u001b[K\rremote: Counting objects:  55% (1436/2610)\u001b[K\rremote: Counting objects:  56% (1462/2610)\u001b[K\rremote: Counting objects:  57% (1488/2610)\u001b[K\rremote: Counting objects:  58% (1514/2610)\u001b[K\rremote: Counting objects:  59% (1540/2610)\u001b[K\rremote: Counting objects:  60% (1566/2610)\u001b[K\rremote: Counting objects:  61% (1593/2610)\u001b[K\rremote: Counting objects:  62% (1619/2610)\u001b[K\rremote: Counting objects:  63% (1645/2610)\u001b[K\rremote: Counting objects:  64% (1671/2610)\u001b[K\rremote: Counting objects:  65% (1697/2610)\u001b[K\rremote: Counting objects:  66% (1723/2610)\u001b[K\rremote: Counting objects:  67% (1749/2610)\u001b[K\rremote: Counting objects:  68% (1775/2610)\u001b[K\rremote: Counting objects:  69% (1801/2610)\u001b[K\rremote: Counting objects:  70% (1827/2610)\u001b[K\rremote: Counting objects:  71% (1854/2610)\u001b[K\rremote: Counting objects:  72% (1880/2610)\u001b[K\rremote: Counting objects:  73% (1906/2610)\u001b[K\rremote: Counting objects:  74% (1932/2610)\u001b[K\rremote: Counting objects:  75% (1958/2610)\u001b[K\rremote: Counting objects:  76% (1984/2610)\u001b[K\rremote: Counting objects:  77% (2010/2610)\u001b[K\rremote: Counting objects:  78% (2036/2610)\u001b[K\rremote: Counting objects:  79% (2062/2610)\u001b[K\rremote: Counting objects:  80% (2088/2610)\u001b[K\rremote: Counting objects:  81% (2115/2610)\u001b[K\rremote: Counting objects:  82% (2141/2610)\u001b[K\rremote: Counting objects:  83% (2167/2610)\u001b[K\rremote: Counting objects:  84% (2193/2610)\u001b[K\rremote: Counting objects:  85% (2219/2610)\u001b[K\rremote: Counting objects:  86% (2245/2610)\u001b[K\rremote: Counting objects:  87% (2271/2610)\u001b[K\rremote: Counting objects:  88% (2297/2610)\u001b[K\rremote: Counting objects:  89% (2323/2610)\u001b[K\rremote: Counting objects:  90% (2349/2610)\u001b[K\rremote: Counting objects:  91% (2376/2610)\u001b[K\rremote: Counting objects:  92% (2402/2610)\u001b[K\rremote: Counting objects:  93% (2428/2610)\u001b[K\rremote: Counting objects:  94% (2454/2610)\u001b[K\rremote: Counting objects:  95% (2480/2610)\u001b[K\rremote: Counting objects:  96% (2506/2610)\u001b[K\rremote: Counting objects:  97% (2532/2610)\u001b[K\rremote: Counting objects:  98% (2558/2610)\u001b[K\rremote: Counting objects:  99% (2584/2610)\u001b[K\rremote: Counting objects: 100% (2610/2610)\u001b[K\rremote: Counting objects: 100% (2610/2610), done.\u001b[K\r\r\nremote: Compressing objects:   0% (1/1037)\u001b[K\rremote: Compressing objects:   1% (11/1037)\u001b[K\rremote: Compressing objects:   2% (21/1037)\u001b[K\rremote: Compressing objects:   3% (32/1037)\u001b[K\rremote: Compressing objects:   4% (42/1037)\u001b[K\rremote: Compressing objects:   5% (52/1037)\u001b[K\rremote: Compressing objects:   6% (63/1037)\u001b[K\rremote: Compressing objects:   7% (73/1037)\u001b[K\rremote: Compressing objects:   8% (83/1037)\u001b[K\rremote: Compressing objects:   9% (94/1037)\u001b[K\rremote: Compressing objects:  10% (104/1037)\u001b[K\rremote: Compressing objects:  11% (115/1037)\u001b[K\rremote: Compressing objects:  12% (125/1037)\u001b[K\rremote: Compressing objects:  13% (135/1037)\u001b[K\rremote: Compressing objects:  14% (146/1037)\u001b[K\rremote: Compressing objects:  15% (156/1037)\u001b[K\rremote: Compressing objects:  16% (166/1037)\u001b[K\rremote: Compressing objects:  17% (177/1037)\u001b[K\rremote: Compressing objects:  18% (187/1037)\u001b[K\rremote: Compressing objects:  19% (198/1037)\u001b[K\rremote: Compressing objects:  20% (208/1037)\u001b[K\rremote: Compressing objects:  21% (218/1037)\u001b[K\rremote: Compressing objects:  22% (229/1037)\u001b[K\rremote: Compressing objects:  23% (239/1037)\u001b[K\rremote: Compressing objects:  24% (249/1037)\u001b[K\rremote: Compressing objects:  25% (260/1037)\u001b[K\rremote: Compressing objects:  26% (270/1037)\u001b[K\rremote: Compressing objects:  27% (280/1037)\u001b[K\rremote: Compressing objects:  28% (291/1037)\u001b[K\rremote: Compressing objects:  29% (301/1037)\u001b[K\rremote: Compressing objects:  30% (312/1037)\u001b[K\rremote: Compressing objects:  31% (322/1037)\u001b[K\rremote: Compressing objects:  32% (332/1037)\u001b[K\rremote: Compressing objects:  33% (343/1037)\u001b[K\rremote: Compressing objects:  34% (353/1037)\u001b[K\rremote: Compressing objects:  35% (363/1037)\u001b[K\rremote: Compressing objects:  36% (374/1037)\u001b[K\rremote: Compressing objects:  37% (384/1037)\u001b[K\rremote: Compressing objects:  38% (395/1037)\u001b[K\rremote: Compressing objects:  39% (405/1037)\u001b[K\rremote: Compressing objects:  40% (415/1037)\u001b[K\rremote: Compressing objects:  41% (426/1037)\u001b[K\rremote: Compressing objects:  42% (436/1037)\u001b[K\rremote: Compressing objects:  43% (446/1037)\u001b[K\rremote: Compressing objects:  44% (457/1037)\u001b[K\rremote: Compressing objects:  45% (467/1037)\u001b[K\rremote: Compressing objects:  46% (478/1037)\u001b[K\rremote: Compressing objects:  47% (488/1037)\u001b[K\rremote: Compressing objects:  48% (498/1037)\u001b[K\rremote: Compressing objects:  49% (509/1037)\u001b[K\rremote: Compressing objects:  50% (519/1037)\u001b[K\rremote: Compressing objects:  51% (529/1037)\u001b[K\rremote: Compressing objects:  52% (540/1037)\u001b[K\rremote: Compressing objects:  53% (550/1037)\u001b[K\rremote: Compressing objects:  54% (560/1037)\u001b[K\rremote: Compressing objects:  55% (571/1037)\u001b[K\rremote: Compressing objects:  56% (581/1037)\u001b[K\rremote: Compressing objects:  57% (592/1037)\u001b[K\rremote: Compressing objects:  58% (602/1037)\u001b[K\rremote: Compressing objects:  59% (612/1037)\u001b[K\rremote: Compressing objects:  60% (623/1037)\u001b[K\rremote: Compressing objects:  61% (633/1037)\u001b[K\rremote: Compressing objects:  62% (643/1037)\u001b[K\rremote: Compressing objects:  63% (654/1037)\u001b[K\rremote: Compressing objects:  64% (664/1037)\u001b[K\rremote: Compressing objects:  65% (675/1037)\u001b[K\rremote: Compressing objects:  66% (685/1037)\u001b[K\rremote: Compressing objects:  67% (695/1037)\u001b[K\rremote: Compressing objects:  68% (706/1037)\u001b[K\rremote: Compressing objects:  69% (716/1037)\u001b[K\rremote: Compressing objects:  70% (726/1037)\u001b[K\rremote: Compressing objects:  71% (737/1037)\u001b[K\rremote: Compressing objects:  72% (747/1037)\u001b[K\rremote: Compressing objects:  73% (758/1037)\u001b[K\rremote: Compressing objects:  74% (768/1037)\u001b[K\rremote: Compressing objects:  75% (778/1037)\u001b[K\rremote: Compressing objects:  76% (789/1037)\u001b[K\rremote: Compressing objects:  77% (799/1037)\u001b[K\rremote: Compressing objects:  78% (809/1037)\u001b[K\rremote: Compressing objects:  79% (820/1037)\u001b[K\rremote: Compressing objects:  80% (830/1037)\u001b[K\rremote: Compressing objects:  81% (840/1037)\u001b[K\rremote: Compressing objects:  82% (851/1037)\u001b[K\rremote: Compressing objects:  83% (861/1037)\u001b[K\rremote: Compressing objects:  84% (872/1037)\u001b[K\rremote: Compressing objects:  85% (882/1037)\u001b[K\rremote: Compressing objects:  86% (892/1037)\u001b[K\rremote: Compressing objects:  87% (903/1037)\u001b[K\rremote: Compressing objects:  88% (913/1037)\u001b[K\rremote: Compressing objects:  89% (923/1037)\u001b[K\rremote: Compressing objects:  90% (934/1037)\u001b[K\rremote: Compressing objects:  91% (944/1037)\u001b[K\rremote: Compressing objects:  92% (955/1037)\u001b[K\rremote: Compressing objects:  93% (965/1037)\u001b[K\rremote: Compressing objects:  94% (975/1037)\u001b[K\rremote: Compressing objects:  95% (986/1037)\u001b[K\rremote: Compressing objects:  96% (996/1037)\u001b[K\rremote: Compressing objects:  97% (1006/1037)\u001b[K\rremote: Compressing objects:  98% (1017/1037)\u001b[K\rremote: Compressing objects:  99% (1027/1037)\u001b[K\rremote: Compressing objects: 100% (1037/1037)\u001b[K\rremote: Compressing objects: 100% (1037/1037), done.\u001b[K\r\r\nReceiving objects:   0% (1/5989)   \rReceiving objects:   1% (60/5989)   \rReceiving objects:   2% (120/5989)   \rReceiving objects:   3% (180/5989)   \rReceiving objects:   4% (240/5989)   \rReceiving objects:   5% (300/5989)   \rReceiving objects:   6% (360/5989)   \rReceiving objects:   7% (420/5989)   \rReceiving objects:   8% (480/5989)   \rReceiving objects:   9% (540/5989)   \rReceiving objects:  10% (599/5989)   \rReceiving objects:  11% (659/5989)   \rReceiving objects:  12% (719/5989)   \rReceiving objects:  13% (779/5989)   \rReceiving objects:  14% (839/5989)   \rReceiving objects:  15% (899/5989)   \rReceiving objects:  16% (959/5989)   \rReceiving objects:  17% (1019/5989)   \rReceiving objects:  18% (1079/5989)   \rReceiving objects:  19% (1138/5989)   \rReceiving objects:  20% (1198/5989)   \rReceiving objects:  21% (1258/5989)   \rReceiving objects:  22% (1318/5989)   \rReceiving objects:  23% (1378/5989)   \rReceiving objects:  24% (1438/5989)   \rReceiving objects:  25% (1498/5989)   \rReceiving objects:  26% (1558/5989)   \rReceiving objects:  27% (1618/5989)   \rReceiving objects:  28% (1677/5989)   \rReceiving objects:  29% (1737/5989)   \rReceiving objects:  30% (1797/5989)   \rReceiving objects:  31% (1857/5989)   \rReceiving objects:  32% (1917/5989)   \rReceiving objects:  33% (1977/5989)   \rReceiving objects:  34% (2037/5989)   \rReceiving objects:  35% (2097/5989)   \rReceiving objects:  36% (2157/5989)   \rReceiving objects:  37% (2216/5989)   \rReceiving objects:  38% (2276/5989)   \rReceiving objects:  39% (2336/5989)   \rReceiving objects:  40% (2396/5989)   \rReceiving objects:  41% (2456/5989)   \rReceiving objects:  42% (2516/5989)   \rReceiving objects:  43% (2576/5989)   \rReceiving objects:  44% (2636/5989)   \rReceiving objects:  45% (2696/5989)   \rReceiving objects:  46% (2755/5989)   \rReceiving objects:  47% (2815/5989)   \rReceiving objects:  48% (2875/5989)   \rReceiving objects:  49% (2935/5989)   \rReceiving objects:  50% (2995/5989)   \rReceiving objects:  51% (3055/5989)   \rReceiving objects:  52% (3115/5989)   \rReceiving objects:  53% (3175/5989)   \rReceiving objects:  54% (3235/5989)   \rReceiving objects:  55% (3294/5989)   \rReceiving objects:  56% (3354/5989)   \rReceiving objects:  56% (3376/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  57% (3414/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  58% (3474/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  59% (3534/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  60% (3594/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  61% (3654/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  62% (3714/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  63% (3774/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  64% (3833/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  65% (3893/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  66% (3953/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  67% (4013/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  68% (4073/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  69% (4133/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  70% (4193/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  71% (4253/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  72% (4313/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  73% (4372/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  74% (4432/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  75% (4492/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  76% (4552/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  77% (4612/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  78% (4672/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  79% (4732/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  80% (4792/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  81% (4852/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  82% (4911/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  83% (4971/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  84% (5031/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  85% (5091/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  86% (5151/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  87% (5211/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  88% (5271/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  89% (5331/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  90% (5391/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  91% (5450/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  92% (5510/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  93% (5570/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  94% (5630/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  95% (5690/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  96% (5750/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  97% (5810/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects:  98% (5870/5989), 3.68 MiB | 3.67 MiB/s   \rremote: Total 5989 (delta 1747), reused 2346 (delta 1544), pack-reused 3379\u001b[K\r\r\nReceiving objects:  99% (5930/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects: 100% (5989/5989), 3.68 MiB | 3.67 MiB/s   \rReceiving objects: 100% (5989/5989), 8.09 MiB | 5.59 MiB/s, done.\r\r\nResolving deltas:   0% (0/4062)   \rResolving deltas:   2% (109/4062)   \rResolving deltas:   3% (127/4062)   \rResolving deltas:   4% (170/4062)   \rResolving deltas:   5% (211/4062)   \rResolving deltas:   6% (276/4062)   \rResolving deltas:   7% (288/4062)   \rResolving deltas:   8% (340/4062)   \rResolving deltas:   9% (367/4062)   \rResolving deltas:  16% (686/4062)   \rResolving deltas:  17% (694/4062)   \rResolving deltas:  18% (743/4062)   \rResolving deltas:  19% (774/4062)   \rResolving deltas:  20% (819/4062)   \rResolving deltas:  21% (871/4062)   \rResolving deltas:  22% (901/4062)   \rResolving deltas:  23% (939/4062)   \rResolving deltas:  25% (1052/4062)   \rResolving deltas:  26% (1080/4062)   \rResolving deltas:  28% (1141/4062)   \rResolving deltas:  29% (1192/4062)   \rResolving deltas:  31% (1279/4062)   \rResolving deltas:  32% (1327/4062)   \rResolving deltas:  33% (1343/4062)   \rResolving deltas:  34% (1384/4062)   \rResolving deltas:  35% (1423/4062)   \rResolving deltas:  37% (1506/4062)   \rResolving deltas:  38% (1554/4062)   \rResolving deltas:  39% (1601/4062)   \rResolving deltas:  40% (1648/4062)   \rResolving deltas:  42% (1742/4062)   \rResolving deltas:  43% (1754/4062)   \rResolving deltas:  44% (1790/4062)   \rResolving deltas:  46% (1876/4062)   \rResolving deltas:  47% (1912/4062)   \rResolving deltas:  48% (1950/4062)   \rResolving deltas:  49% (1993/4062)   \rResolving deltas:  50% (2032/4062)   \rResolving deltas:  51% (2079/4062)   \rResolving deltas:  52% (2127/4062)   \rResolving deltas:  53% (2161/4062)   \rResolving deltas:  54% (2197/4062)   \rResolving deltas:  55% (2248/4062)   \rResolving deltas:  56% (2275/4062)   \rResolving deltas:  57% (2335/4062)   \rResolving deltas:  58% (2357/4062)   \rResolving deltas:  64% (2610/4062)   \rResolving deltas:  66% (2694/4062)   \rResolving deltas:  67% (2742/4062)   \rResolving deltas:  68% (2768/4062)   \rResolving deltas:  69% (2821/4062)   \rResolving deltas:  71% (2891/4062)   \rResolving deltas:  72% (2936/4062)   \rResolving deltas:  73% (2968/4062)   \rResolving deltas:  74% (3025/4062)   \rResolving deltas:  77% (3134/4062)   \rResolving deltas:  79% (3209/4062)   \rResolving deltas:  80% (3263/4062)   \rResolving deltas:  82% (3333/4062)   \rResolving deltas:  83% (3380/4062)   \rResolving deltas:  84% (3420/4062)   \rResolving deltas:  85% (3460/4062)   \rResolving deltas:  86% (3495/4062)   \rResolving deltas:  87% (3541/4062)   \rResolving deltas:  88% (3577/4062)   \rResolving deltas:  89% (3627/4062)   \rResolving deltas:  90% (3659/4062)   \rResolving deltas:  91% (3697/4062)   \rResolving deltas:  92% (3743/4062)   \rResolving deltas:  93% (3780/4062)   \rResolving deltas:  94% (3819/4062)   \rResolving deltas:  95% (3866/4062)   \rResolving deltas:  96% (3907/4062)   \rResolving deltas:  97% (3952/4062)   \rResolving deltas:  98% (3985/4062)   \rResolving deltas:  99% (4026/4062)   \rResolving deltas: 100% (4062/4062)   \rResolving deltas: 100% (4062/4062), done.\r\r\n\u001b[90m# \u21b3 Command completed in 2.735228999s\u001b[0m\r\n\u001b[90m$\u001b[0m git clean -ffxdq\r\n\u001b[90m# \u21b3 Command completed in 1.534243ms\u001b[0m\r\n\u001b[90m$\u001b[0m git fetch origin 4416ce9a1bbd38505c72f8f9d034a45c41b02a02\r\nFrom github.com:segmentio/tracing\r\r\n * branch            4416ce9a1bbd38505c72f8f9d034a45c41b02a02 -> FETCH_HEAD\r\r\n\u001b[90m# \u21b3 Command completed in 919.62868ms\u001b[0m\r\n\u001b[90m$\u001b[0m git checkout -f 4416ce9a1bbd38505c72f8f9d034a45c41b02a02\r\nNote: checking out '4416ce9a1bbd38505c72f8f9d034a45c41b02a02'.\r\r\n\r\r\nYou are in 'detached HEAD' state. You can look around, make experimental\r\r\nchanges and commit them, and you can discard any commits you make in this\r\r\nstate without impacting any branches by performing another checkout.\r\r\n\r\r\nIf you want to create a new branch to retain commits you create, you may\r\r\ndo so (now or later) by using -b with the checkout command again. Example:\r\r\n\r\r\n  git checkout -b <new-branch-name>\r\r\n\r\r\nHEAD is now at 4416ce9 span/kafka: skip tests with offline Kafka server\r\r\n\u001b[90m# \u21b3 Command completed in 10.129911ms\u001b[0m\r\n\u001b[90m# Cleaning again to catch any post-checkout changes\u001b[0m\r\n\u001b[90m$\u001b[0m git clean -ffxdq\r\n\u001b[90m# \u21b3 Command completed in 1.393502ms\u001b[0m\r\n\u001b[90m# Checking to see if Git data needs to be sent to Buildkite\u001b[0m\r\n\u001b[90m$\u001b[0m buildkite-agent meta-data exists buildkite:git:commit\r\n\u001b[90m# \u21b3 Command completed in 346.913328ms\u001b[0m\r\n\u001b[90m# Sending Git commit information back to Buildkite\u001b[0m\r\n\u001b[90m$\u001b[0m git --no-pager show HEAD -s --format=fuller --no-color\r\n\u001b[90m# \u21b3 Command completed in 1.519491ms\u001b[0m\r\n\u001b[90m$\u001b[0m buildkite-agent meta-data set buildkite:git:commit \"commit 4416ce9a1bbd38505c72f8f9d034a45c41b02a02\\nAuthor:     Kevin Burke <kevin.burke@segment.com>\\nAuthorDate: Mon Mar 7 ...\"\r\n\u001b[90m# \u21b3 Command completed in 368.272109ms\u001b[0m\r\n~~~ Running global post-checkout hook\r\n\u001b[90m# A hook runner was written to \"/tmp/buildkite-agent-bootstrap-hook-runner-621722600\" with the following:\u001b[0m\r\n\u001b[90m$\u001b[0m /tmp/buildkite-agent-bootstrap-hook-runner-621722600\r\n\u001b[90m# \u21b3 Command completed in 5.362001ms\u001b[0m\r\n\u001b[90m# BUILDKITE_SHORT_COMMIT changed\u001b[0m\r\n\u001b[90m# TREB_IMAGE_TAG changed\u001b[0m\r\n\u001b[90m# BUILDKITE_COMMIT_REVISION changed\u001b[0m\r\n\u001b[90m# TREB_SHORT_IMAGE_TAG changed\u001b[0m\r\n~~~ Running global pre-command hook\r\n\u001b[90m# A hook runner was written to \"/tmp/buildkite-agent-bootstrap-hook-runner-601842929\" with the following:\u001b[0m\r\n\u001b[90m$\u001b[0m /tmp/buildkite-agent-bootstrap-hook-runner-601842929\r\n\u001b[90m# \u21b3 Command completed in 5.089388ms\u001b[0m\r\n~~~ Running commands\r\n\u001b[90m$\u001b[0m /bin/bash -e -c \"trap 'kill -- $$' INT TERM QUIT; buildkite-agent pipeline upload\"\r\n\u001b[38;5;48m2022-03-08 19:16:09 INFO  \u001b[0m \u001b[0mSearching for pipeline config...\u001b[0m\r\r\n\u001b[38;5;48m2022-03-08 19:16:09 INFO  \u001b[0m \u001b[0mFound config file \".buildkite/pipeline.yml\"\u001b[0m\r\r\n\u001b[38;5;48m2022-03-08 19:16:09 INFO  \u001b[0m \u001b[0mUpdating BUILDKITE_COMMIT to \"4416ce9a1bbd38505c72f8f9d034a45c41b02a02\"\u001b[0m\r\r\n\u001b[38;5;48m2022-03-08 19:16:10 INFO  \u001b[0m \u001b[0mSuccessfully uploaded and parsed pipeline config\u001b[0m\r\r\n\u001b[90m# \u21b3 Command completed in 993.046521ms\u001b[0m\r\n~~~ Running global post-command hook\r\n\u001b[90m# A hook runner was written to \"/tmp/buildkite-agent-bootstrap-hook-runner-101841198\" with the following:\u001b[0m\r\n\u001b[90m$\u001b[0m /tmp/buildkite-agent-bootstrap-hook-runner-101841198\r\n~~~ Fixing permissions\r\r\n\u001b[90m# \u21b3 Command completed in 2.59012113s\u001b[0m\r\n~~~ Running global pre-exit hook\r\n\u001b[90m# A hook runner was written to \"/tmp/buildkite-agent-bootstrap-hook-runner-926594223\" with the following:\u001b[0m\r\n\u001b[90m$\u001b[0m /tmp/buildkite-agent-bootstrap-hook-runner-926594223\r\n\u001b[90m# \u21b3 Command completed in 5.277174ms\u001b[0m\r\nResetting docker state...\r\nRemoving running containers...\r\nRemoving container /pedantic_sinoussi\r\n/pedantic_sinoussi\r\nRemoving volumes...\r\nrm: cannot remove '/var/lib/buildkite-agent/.tmp/job-netrc-fca912da-fe38-4bf5-b8df-980ce0367aff': No such file or directory\r\n",
    "size": 31556,
    "header_times": [
        1646766959558858236,
        1646766960955429984,
        1646766960955604026,
        1646766965561125384,
        1646766965567059633,
        1646766969956688546,
        1646766969963785959,
        1646766969970087024,
        1646766970963249363,
        1646766970968426718,
        1646766973554300132,
        1646766973815364000
    ]
}
`)

func TestJSONUnmarshal(t *testing.T) {
	t.Run("Builds", func(t *testing.T) {
		var builds []Build
		if err := json.Unmarshal(buildsResponse, &builds); err != nil {
			t.Fatal(err)
		}
		if len(builds) != 3 {
			t.Errorf("should have gotten 3 builds, got %d", len(builds))
		}
	})
	t.Run("Log", func(t *testing.T) {
		var log Log
		if err := json.Unmarshal(logResponse, &log); err != nil {
			t.Fatal(err)
		}
		if len(log.Content) < 1000 {
			t.Errorf("should have log content, got %q", log.Content)
		}
	})
}
